{"version":3,"file":null,"sources":["../lib/index.js"],"sourcesContent":["import { Stream } from '@tempest/core';\nexport function sample(sampler, stream) {\n    return new Stream(new Sample(sampler.source, stream.source));\n}\nexport class Sample {\n    constructor(sampler, source) {\n        this.sampler = sampler;\n        this.source = source;\n    }\n    run(sink, scheduler) {\n        const sampleSink = new SampleSink(sink);\n        const samplerDisposable = this.sampler.run(sampleSink, scheduler);\n        const sourceDisposable = this.source.run(sampleSink.hold, scheduler);\n        return new SampleDisposable(samplerDisposable, sourceDisposable);\n    }\n}\nclass SampleSink {\n    constructor(sink) {\n        this.sink = sink;\n        this.hold = new SampleHold(this);\n    }\n    event(time, value) {\n        if (this.hold.hasValue) {\n            this.sink.event(time, this.hold.value);\n        }\n    }\n    error(time, err) {\n        this.sink.error(time, err);\n    }\n    end(time, value) {\n        this.sink.end(time, this.hold.value);\n    }\n}\nclass SampleHold {\n    constructor(sink) {\n        this.sink = sink;\n        this.hasValue = false;\n        this.value = void 0;\n    }\n    event(time, value) {\n        this.hasValue = true;\n        this.value = value;\n    }\n    error(time, err) {\n        this.sink.error(time, err);\n    }\n    end(time, value) {\n        return void 0;\n    }\n}\nclass SampleDisposable {\n    constructor(sampleDisposable, sourceDisposable) {\n        this.sampleDisposable = sampleDisposable;\n        this.sourceDisposable = sourceDisposable;\n    }\n    dispose() {\n        this.sampleDisposable.dispose();\n        this.sourceDisposable.dispose();\n    }\n}\n//# sourceMappingURL=index.js.map"],"names":["Stream"],"mappings":"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"}