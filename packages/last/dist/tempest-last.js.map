{"version":3,"file":null,"sources":["../lib/index.js"],"sourcesContent":["import { Stream } from '@tempest/core';\nexport function last(stream) {\n    return new Stream(new Last(stream.source));\n}\nexport class Last {\n    constructor(source) {\n        this.source = source;\n    }\n    run(sink, scheduler) {\n        return this.source.run(new LastSink(sink), scheduler);\n    }\n}\nclass LastSink {\n    constructor(sink) {\n        this.sink = sink;\n        this.has = false;\n    }\n    event(time, value) {\n        this.has = true;\n        this.value = value;\n    }\n    error(time, err) {\n        this.has = false;\n        this.sink.error(time, err);\n    }\n    end(time, value) {\n        if (this.has) {\n            this.sink.event(time, this.value);\n            this.has = false;\n        }\n        this.sink.end(time, value);\n    }\n}\n//# sourceMappingURL=index.js.map"],"names":["Stream"],"mappings":";;;;;;IACO,SAAS,IAAI,CAAC,MAAM,EAAE;QACzB,OAAO,IAAIA,oBAAM,CAAC,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC;KAC9C;AACD,AAAO,IAAA,IAAM,IAAI,GAAC,aACH,CAAC,MAAM,EAAE;QACpB,IAAQ,CAAC,MAAM,GAAG,MAAM,CAAC;AAC7B,IAAA,CAAK,CAAA;AACL,IAAA,eAAI,GAAG,iBAAC,IAAI,EAAE,SAAS,EAAE;QACrB,OAAW,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,QAAQ,CAAC,IAAI,CAAC,EAAE,SAAS,CAAC,CAAC;AAC9D,IAAA,CAAK,CAAA;AAEL,IAAA,IAAM,QAAQ,GAAC,iBACA,CAAC,IAAI,EAAE;QAClB,IAAQ,CAAC,IAAI,GAAG,IAAI,CAAC;QACrB,IAAQ,CAAC,GAAG,GAAG,KAAK,CAAC;AACzB,IAAA,CAAK,CAAA;AACL,IAAA,mBAAI,KAAK,mBAAC,IAAI,EAAE,KAAK,EAAE;QACnB,IAAQ,CAAC,GAAG,GAAG,IAAI,CAAC;QACpB,IAAQ,CAAC,KAAK,GAAG,KAAK,CAAC;AAC3B,IAAA,CAAK,CAAA;AACL,IAAA,mBAAI,KAAK,mBAAC,IAAI,EAAE,GAAG,EAAE;QACjB,IAAQ,CAAC,GAAG,GAAG,KAAK,CAAC;QACrB,IAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;AACnC,IAAA,CAAK,CAAA;AACL,IAAA,mBAAI,GAAG,iBAAC,IAAI,EAAE,KAAK,EAAE;QACjB,IAAQ,IAAI,CAAC,GAAG,EAAE;YACd,IAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;YACtC,IAAQ,CAAC,GAAG,GAAG,KAAK,CAAC;SACpB;QACL,IAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;AACnC,IAAA,CAAK,CAAA;;;;;;;"}